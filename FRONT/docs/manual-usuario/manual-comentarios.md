# Comentarios del Huerto

Esta sección te permite registrar actividades y conversar sobre un huerto específico. Aquí aprenderás a:
- Agregar comentarios y registrar actividades.
- Conocer los tipos de comentarios disponibles.
- Usar los filtros y la paginación.
- Asignar y gestionar residentes del huerto (solo administradores) y entender sus permisos.
- Cambiar la imagen del huerto.

---

## 1) Agregar un comentario o actividad
1. En la parte superior izquierda verás el nombre del huerto y el botón **“Agregar Comentario”**. También puede aparecer cuando no hay comentarios (botón “Agregar Primer Comentario”).
2. Se abrirá un formulario con:
   - **Comentario**: escribe la descripción en texto libre.
   - **Tipo de Actividad**: selecciona qué tipo de comentario crear.
   - Campos adicionales que cambian según el tipo elegido.
3. Pulsa **Publicar** para guardar.

Si no ves el botón, probablemente no tienes permisos para crear comentarios (ver sección Permisos).

---

## 2) Tipos de comentarios y campos
Al elegir el **Tipo de Actividad** puedes registrar datos específicos:

- **📝 General**: solo texto libre.
- **💧 Riego**:
  - Cantidad de agua y unidad (mL o L).
- **🌱 Siembra**:
  - Nombre de la siembra (opcional, texto).
  - Número de plantas sembradas.
- **✂️ Cosecha**:
  - Seleccionar la siembra cosechada (debe existir una siembra previa).
  - Producción cosechada (cantidad).
- **🍃 Abono**:
  - Cantidad de abono y unidad (kg o g).
  - ¿Se cambió la tierra? (sí/por encima).
- **🐛 Plagas**:
  - Especie de plaga (texto).
  - Nivel de infestación (pocos/medio/muchos).
- **🔧 Mantenimiento**:
  - Tiempo de mantenimiento y unidad (minutos/horas).

Además, para todos los tipos excepto “General”, “Siembra” y “Cosecha”, puedes relacionar el comentario con una siembra mediante “Huerto de:” (selecciona una siembra existente).

---

## 3) Ver, editar y eliminar
- Al abrir un comentario podrás ver sus detalles. Si tienes permisos, verás acciones para **Editar** o **Eliminar**.
- Los administradores y técnicos pueden editar/eliminar cualquier comentario.
- Los residentes asignados solo pueden editar/eliminar sus propios comentarios.

---

## 4) Filtros de comentarios y búsqueda
Arriba de la lista verás controles de búsqueda y filtros:
- **Buscar**: escribe texto para filtrar por contenido o autor.
- **Categorías**: botones como “Todos”, “General”, “Riego”, “Siembra”, etc. Selecciona uno para ver solo ese tipo.
- La lista está **paginada**; usa los botones “Anterior/Siguiente” o los números de página para navegar.

---

## 5) Asignación de residentes y permisos
La asignación de residentes define quién puede participar activamente en el huerto.

### 5.1 ¿Quién puede asignar?
- Solo los **Administradores** verán el panel “Gestionar Residentes” dentro de la página del huerto.
- Desde ahí pueden **Asignar** o **Eliminar** residentes del huerto.

### 5.2 Permisos por rol
- **Administrador**: ver/crear/editar/eliminar comentarios; gestionar residentes; cambiar imagen.
- **Técnico**: ver/crear/editar/eliminar comentarios.
- **Residente asignado**: ver comentarios; crear, editar y eliminar los suyos; puede darse de baja del huerto.
- **Residente no asignado**: solo ver comentarios (no puede crear/editar/eliminar).

Nota: Al darse de baja, el residente deja de poder crear/editar/eliminar pero aún puede ver, y puede ser reasignado más tarde por un administrador.

---

## 6) Darse de baja del huerto (solo residentes asignados)
- Usa el botón **“Darse de baja”**. Aparecerá una confirmación con las consecuencias.
- Tras confirmar, perderás los permisos de creación/edición/eliminación en ese huerto, pero seguirás viendo sus comentarios.

---

## 7) Cambiar la imagen del huerto
1. En el encabezado del huerto verás una tarjeta con la imagen. Pulsa **Cambiar imagen**.
2. Ingresa una **URL de imagen** válida. Verás una **vista previa**.
3. Pulsa **Actualizar Imagen**. La imagen se guardará en el sistema y se mostrará en el encabezado.

Sugerencias:
- Usa una URL estable (por ejemplo, un enlace público a una imagen en un servicio confiable).
- Si la imagen falla, se mostrará una imagen de respaldo.

---

## 8) Consejos y resolución de problemas
- No veo el botón “Agregar Comentario”: verifica tus **permisos** o solicita asignación al administrador.
- No aparece mi siembra en “Cosechado de” o “Huerto de”: primero crea un comentario de **Siembra** en este huerto.
- Error al actualizar imagen: confirma que la **URL** es válida y accesible públicamente.
- No puedo eliminar un comentario: asegúrate de ser **autor** o tener rol **técnico/administrador**.

Con esto podrás registrar actividades, colaborar y gestionar permisos en la sección de comentarios del huerto.
